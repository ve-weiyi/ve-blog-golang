# GoZero 博客项目

## 项目简介

基于 GoZero 框架开发的博客系统，采用微服务架构，包含管理后台和博客前台两个模块，通过 RPC 进行服务间通信。

## 项目结构

```
.
blog-gozero/
├── common/                  # 业务常量和配置
│   ├── constant/            # 常量定义
│   └── rediskey/            # Redis Key 管理
├── infra/                   # 基础设施层
│   ├── gormlogx/            # Gorm 日志
│   ├── interceptorx/        # gRPC 拦截器
│   └── middlewarex/         # HTTP 中间件
├── service/                 # 服务代码
│   ├── api/                 # API 网关层
│   │   ├── admin/           # 后台管理服务
│   │   └── blog/            # 前台博客服务
│   │       ├── docs/        # Swagger 文档
│   │       ├── etc/         # 配置文件
│   │       ├── internal/    # 业务代码
│   │       └── proto/       # api接口定义
│   ├── model/               # 数据模型层（Gorm Models）
│   └── rpc/                 # RPC 服务层
│       └── blog/            # 博客 RPC 服务
│           ├── client/      # RPC 客户端
│           ├── etc/         # 配置文件
│           ├── internal/    # 业务代码
│           └── proto/       # Protobuf 定义
```

## 环境要求

- Go 1.20+
- MySQL 8.0+
- Redis 6.0+
- RabbitMQ 3.8+ (可选)
- Nacos (可选，开发环境可使用本地配置)
- ETCD (可选，开发环境可直连 RPC)

## 快速开始

### 1. 安装依赖

```bash
make deps
```

### 2. 启动依赖服务

```bash
# 启动 MySQL、Redis、RabbitMQ 等服务
make docker-up
```

### 3. 初始化数据库

执行 SQL 文件初始化数据库：

- `blog-veweiyi-init.sql` - 初始化表结构
- `blog-veweiyi-data.sql` - 导入初始数据

### 4. 修改配置

根据实际环境修改配置文件（数据库连接、Redis 地址等）：

- `service/api/blog/etc/blog-api.yaml`
- `service/api/admin/etc/admin-api.yaml`
- `service/rpc/blog/etc/blog-rpc.yaml`

### 5. 启动服务

**方式一：使用 Makefile（推荐）**

```bash
# 在不同终端分别启动
make run-rpc      # 启动 RPC 服务
make run-blog     # 启动博客前台服务
make run-admin    # 启动管理后台服务
```

**方式二：直接运行**

1. 使用本地配置运行

```bash
# 启动 RPC 服务
go run service/rpc/blog/blog.go -f service/rpc/blog/etc/blog.yaml
```

```bash
# 启动博客前台服务
go run service/api/blog/blog.go -f service/api/blog/etc/blog.yaml
```

```bash
# 启动管理后台服务
go run service/api/admin/admin.go -f service/api/admin/etc/admin.yaml
```

2. 使用远程配置运行(生产环境使用Nacos)

```bash
# 启动 RPC 服务
go run service/rpc/blog/blog.go

# 启动博客前台服务
go run service/api/blog/blog.go

# 启动管理后台服务
go run service/api/admin/admin.go
```

### 6. 访问服务

- 博客前台接口：http://localhost:9090/blog-api/v1/swagger/index.html
- 管理后台接口：http://localhost:9091/admin-api/v1/swagger/index.html

## 编译部署

### 编译服务

```bash
make build
```

编译后的可执行文件位于 `bin/` 目录：

- `bin/blog-rpc` - RPC 服务
- `bin/blog-api` - 博客前台服务
- `bin/admin-api` - 管理后台服务

### Docker 部署

```bash
docker-compose -f docker-compose.yaml up -d
```

## 常用命令

```bash
make help         # 查看所有可用命令
make deps         # 安装依赖
make docker-up    # 启动依赖服务
make docker-down  # 停止依赖服务
make run-rpc      # 启动 RPC 服务
make run-blog     # 启动博客前台服务
make run-admin    # 启动管理后台服务
make build        # 编译所有服务
make clean        # 清理编译文件
```

更多命令请看[Makefile](Makefile)。

## 注意事项

1. 服务启动顺序：先启动 RPC 服务，再启动 API 服务
2. 确保依赖服务（MySQL、Redis）正常运行
3. 开发环境使用本地配置文件，生产环境建议使用 Nacos 配置中心
4. 需要在不同终端分别启动各个服务
