# 常用加密方法原理分析和应用

[探索常见加密算法：原理、优缺点及其应用](https://blog.csdn.net/fudaihb/article/details/139106487)

## 加密算法划分

1. 哈希加密：哈希函数可以将任意长度的输入通过散列算法变换成固定长度的输出，这个输出就是哈希值。这是一种单向函数，对于哈希值是无法反向得到原始输入的。常见的哈希函数包括MD5、SHA系列等。哈希函数通常用于验证数据的完整性。
2.

对称加密：对称加密是最早的加密方法，它使用相同的密钥进行加密和解密。常见的对称加密算法包括DES、3DES、AES、RC4等。对称加密算法的优点是加密和解密速度快，适合大量数据的加密；缺点是密钥管理复杂，如果密钥泄露，那么加密信息的安全性就无法保障。

3.

非对称加密：非对称加密使用一对密钥，一个用于加密，另一个用于解密。这两个密钥是不同的，但是它们是相关的，一般一个作为公开的公钥，另一个作为私有的私钥。常见的非对称加密算法包括RSA、ECC等。非对称加密的优点是安全性高，密钥管理方便；缺点是加密和解密的速度慢。

## 加密算法分析

### Hash加密算法

一个优秀的 hash 算法，将能实现：

- 正向快速：给定明文和 hash 算法，在有限时间和有限资源内能计算出 hash 值。
- 逆向困难：给定（若干） hash 值，在有限时间内很难（基本不可能）逆推出明文。
- 输入敏感：原始输入信息修改一点信息，产生的 hash 值看起来应该都有很大不同。
- 冲突避免：很难找到两段内容不同的明文，使得它们的 hash 值一致（发生冲突）。

#### MD5加密算法

* **原理**

消息摘要算法 5（MD5，Message-Digest Algorithm 5）是1991年由 Ronald Rivest 提出的哈希算法。MD5 接受任意长度的数据，并生成一个
128 位（16 字节）的哈希值。

MD5 通过分块处理数据，加上一系列置换和逻辑运算，最终生成固定长度的摘要。

* 优缺点

- 优点：
  快速高效：MD5 的计算速度快，适用于大规模数据处理。
  实现简单：MD5 的算法简单，易于实现。
- 缺点：
  安全性低：随着计算能力的提升，已被证明存在碰撞漏洞，安全性不足。

* **用途**        
  尽管 MD5 已不再推荐用于安全性较高的场景，但在文件完整性校验和快速摘要生成等低安全需求场景中仍有应用。

#### SHA加密算法

* **原理**

安全哈希算法（SHA，Secure Hash Algorithm）系列由 NIST 发布，包括 SHA-1、SHA-2（SHA-224, SHA-256, SHA-384, SHA-512）和 SHA-3 系列。

SHA-1 生成 160 位哈希值，SHA-2 系列生成 224 至 512 位不等的哈希值，SHA-3 系列基于新的算法框架，支持更高的安全性。

优缺点

- 优点：

安全性高：SHA-2 和 SHA-3 系列提供了高安全性，抗碰撞能力强。

灵活性：SHA-2 和 SHA-3 系列支持不同长度的哈希值，适用广泛。

- 缺点：

计算复杂：相较 MD5，SHA 系列计算开销较大。

* **用途**        
  SHA-2 和 SHA-3 系列广泛应用于密码学、数字签名、证书生成和区块链技术等需要高安全性的场景。

#### Bcrypt加密算法

Bcrypt是一种基于Blowfish加密算法的密码哈希函数，以其安全性和防止彩虹表攻击的能力而闻名。

### 对称加密算法：

对称加密，又称为传统加密，是指加密和解密使用相同密钥的加密方式。这种加密方式由于速度快、效率高而广泛应用于数据加密。
具有以下特点：

加解密速度快：对称加密算法通常加解密速度很快。
密钥管理复杂：需要确保密钥的安全性，一旦密钥泄露，加密信息的安全性将受到威胁。

#### DES加密算法

* **原理**        
  数据加密标准（DES，Data Encryption Standard）是由IBM公司设计，并于1977年由美国国家标准与技术研究院（NIST）作为联邦标准发布的加密算法。DES
  使用 56 位长的密钥，对数据进行 64 位分块加密处理。

DES 加密过程包括一系列复杂的置换和替换，经过16轮的迭代来增加数据的混淆度和扩散性，最终输出密文。
优缺点

- 优点：

简单高效：DES 的结构和操作相对简单，硬件和软件实现速度快。

- 缺点：

安全性低：由于密钥长度较短，容易被暴力破解。现今的计算能力可以在合理时间内破解 DES。

* **用途**        
  虽然 DES 现在被认为安全性不足，但在它被发布后的几十年中，广泛应用于金融、政府等领域的数据加密。

#### AES加密算法

* **原理**        
  高级加密标准（AES，Advanced Encryption Standard）是 NIST 于2001年发布的加密算法。AES 使用 128、192 或 256 位长的密钥，对数据进行
  128 位分块加密处理。

AES 的加密过程包括多轮的字节置换、行移位、列混淆和轮密钥加等操作，具有较高的混淆度和扩散性。

优缺点

- 优点：

高安全性：AES 支持多种密钥长度，使得抗暴力破解能力强于 DES。

效率优化：AES 的算法结构有助于在硬件和软件中高效实现。

- 缺点：

实现复杂：相比 DES，AES 的实现相对复杂，对初学者不太友好。

* **用途**        
  AES 被广泛应用于各种场景，例如无线保密通信、电子商务、金融交易等，是目前最为流行的对称加密标准之一。

### 非对称加密算法：

非对称加密，又称公钥加密，是指加密和解密使用不同密钥的加密方式。公钥加密用于加密数据，私钥用于解密，由于密钥管理的便利性和高安全性，广泛用于数据传输安全和数字签名。
具有以下特点：
安全性高：加密和解密使用不同的密钥，提高了安全性。
密钥管理方便：无需将密钥分享给对方。

#### DH加密算法

* **原理**
  Diffie-Hellman（DH）是一种密钥交换协议，由 Whitfield Diffie 和 Martin Hellman 在1976年提出。DH
  协议允许两个通信方在公开的通信信道上生成一个共享的密钥，而不需要直接交换任何秘密信息。这个共享的密钥可以用于后续的对称加密通信。
  DH的工作原理如下：

  1.两个通信方A和B各自选择一个私有的密钥（a和b），这个密钥在整个过程中保持秘密。
  2.A和B使用同样的公开参数（通常是一个大质数和一个原根），并且各自计算一个公开的值（A和B）。这个公开的值是通过将私有密钥和公开参数进行特定的数学运算得到的。
  3.A和B互相交换他们的公开值。
  4.A和B各自使用对方的公开值和自己的私有密钥进行特定的数学运算，得到一个新的值。这个新的值就是共享的密钥。
* **优缺点**
  优点：  
  安全性：DH算法的安全性基于离散对数问题，这是一个在数学上未解决的难题，使得DH算法具有较高的安全性。
  密钥管理：DH算法可以在公开的通信信道上生成共享的密钥，避免了密钥的直接交换，简化了密钥的管理。
  缺点：  
  计算复杂度：DH算法涉及到大数的运算，计算复杂度较高，可能需要较大的计算资源。
  无法防止中间人攻击：如果在密钥交换过程中有第三方拦截并替换了公开的值，那么这个第三方就可以与通信双方各自建立一个共享的密钥，从而窃听通信内容。

* **用途**    
  DH算法广泛应用于各种需要安全通信的场景，例如SSL/TLS协议、IPSec协议、SSH协议等。在这些协议中，DH算法被用于在通信双方之间安全地协商出一个共享的密钥，用于后续的对称加密通信

#### RSA加密算法

* **原理**        
  RSA（Rivest-Shamir-Adleman）是1977年由Ron Rivest、Adi Shamir和Leonard Adleman共同提出的一种非对称加密算法。RSA
  使用一对公钥和私钥，其中公钥用于加密、私钥用于解密。

RSA 的安全性基于大整数分解的数学难题，即使有足够的时间和计算力，分解大整数也是非常困难的。

* **优缺点**

- 优点：

高安全性：非对称加密的密钥长度较长，抗暴力破解能力强。

密钥管理方便：公钥可以公开发布，仅需保护私钥安全。

- 缺点：

计算复杂：RSA 的计算复杂度高，加密和解密速度较慢，不适用于大数据量加密。

* **用途**        
  RSA 常被用于对称密钥的交换、数字签名和证书加密，广泛应用于 HTTPS、电子邮件安全和 VPN 通信中。

#### ECC加密算法

* **原理**        
  椭圆曲线加密（ECC，Elliptic Curve Cryptography）是基于椭圆曲线数学理论的一种加密算法。ECC 通过定义在有限域上的椭圆曲线上的点的数学特性，实现公钥加密。

ECC 的安全性依赖于椭圆曲线离散对数问题的复杂性，比传统的 RSA 算法具有更高的安全性和效率。

* **优缺点**

- 优点：

高安全性：在相同安全级别下，ECC 所需的密钥长度远小于 RSA，抗暴力破解能力强。

高效率：ECC 的计算效率更高，适用于资源受限的环境。

- 缺点：

实现复杂：ECC 的数学理论较为复杂，对开发者有较高的要求。

* **用途**        
  ECC 广泛应用于移动设备、智能卡和物联网设备的数据传输安全中，逐渐成为非对称加密的主流技术之一。

## 加密算法应用

### HTTPS

HTTPS（Hyper Text Transfer Protocol Secure）是一种通过计算机网络进行安全通信的传输协议。HTTPS 通过 HTTP 进行通信，但利用
SSL/TLS 来加密数据包。HTTPS 的主要目的是提供对网站服务器的身份认证，保护交换数据的隐私与完整性。  
以下是 HTTPS 的工作原理：

1. 建立连接：当客户端（通常是浏览器）尝试与支持 HTTPS 的服务器建立连接时，会首先发送一个请求来建立一个安全连接，这个过程被称为
   SSL/TLS 握手。
2. 服务器身份验证：服务器会返回一个包含其 SSL/TLS
   证书的消息。这个证书包含了服务器的公钥和一些身份信息，同时这个证书是由一个受信任的第三方（称为证书颁发机构，CA）签发的。客户端会验证这个证书的有效性。
3. 密钥交换：如果证书有效，客户端会生成一串随机的字节串（称为预主密钥），然后用服务器的公钥加密这串字节串，然后发送给服务器。服务器用自己的私钥解密这串字节串，得到预主密钥。
4. 会话密钥生成：客户端和服务器都有了预主密钥，然后双方会用这个预主密钥来生成会话密钥，这个会话密钥会用于接下来的会话中加密和解密数据。
5. 数据传输：客户端和服务器现在可以安全地交换加密的信息了。所有发送的数据都会用会话密钥加密，接收方收到数据后用会话密钥解密。
6. 连接关闭：当信息交换完成后，客户端和服务器会安全地关闭连接。  
   这个过程确保了即使数据在传输过程中被拦截，攻击者也无法解密数据，因为他们没有会话密钥。同时，由于证书的存在，客户端可以确认他们正在与真正的服务器进行通信，而不是一个冒充的服务器。

SSL
SSL（Secure Sockets Layer）是一种安全协议，用于在互联网上保护数据的完整性和隐私。SSL
使用加密算法确保数据在传输过程中的安全，并使用证书和密钥来验证参与通信的双方身份。以下是 SSL 的工作原理：

1. 握手阶段：当客户端（如浏览器）尝试与服务器建立 SSL 连接时，会首先进行一个握手过程。在这个过程中，客户端会向服务器发送一个“Client
   Hello”消息，包含客户端支持的 SSL 版本、加密套件列表（包含加密算法和哈希函数）以及一个随机数。
2. 服务器响应：服务器收到“Client Hello”消息后，会选择一个客户端支持的 SSL 版本和加密套件，然后生成一个随机数，并将这些信息以及服务器的证书（包含公钥）一起发送给客户端。
3. 客户端验证：客户端收到服务器的证书后，会验证证书的有效性。验证包括检查证书是否过期，是否被受信任的证书颁发机构（CA）签发，以及证书中的域名是否与服务器的域名匹配。
4. 密钥交换：如果证书验证通过，客户端会生成一个新的随机数（预主密钥），然后使用服务器的公钥将其加密，发送给服务器。服务器使用自己的私钥解密，获取到预主密钥。
5. 会话密钥生成：客户端和服务器现在都有了三个随机数（客户端随机数、服务器随机数和预主密钥），它们会使用这三个随机数生成会话密钥，用于接下来的加密和解密数据。
6.

数据传输：握手过程结束后，客户端和服务器就可以开始安全地交换数据了。所有发送的数据都会用会话密钥加密，接收方收到数据后用会话密钥解密。  
这个过程确保了即使数据在传输过程中被拦截，攻击者也无法解密数据，因为他们没有会话密钥。同时，由于证书的存在，客户端可以确认他们正在与真正的服务器进行通信，而不是一个冒充的服务器。

### ECDH

* 什么是ECDH

ECDH（Elliptic Curve
Diffie-Hellman）是一种基于椭圆曲线密码学的密钥交换协议，用于在通信双方之间安全地协商共享密钥。ECDH是Diffie-Hellman密钥交换协议的一种变体，它利用椭圆曲线上的离散对数问题，提供了一种安全、高效的密钥协商方法。

ECDH的工作原理如下：

密钥生成： 每个通信方都有一对密钥，包括一个公钥和一个私钥。公钥可以公开分享，而私钥则必须保密。

协商阶段： 通信双方通过互相交换各自的公钥，并使用对方的公钥和自己的私钥生成一个共享的对称密钥。

密钥派生： 通过一系列算法，通信双方使用协商得到的共享密钥生成用于加密通信的对称密钥。

ECDH的优势在于它提供了与传统Diffie-Hellman相比更高的安全性，同时使用更短的密钥长度。这使得ECDH成为许多加密协议和安全通信标准的首选密钥交换机制之一，尤其是在资源受限的环境中（如移动设备和物联网设备）。

ECDH流程主要涉及密钥生成、协商阶段和密钥派生。

* ECDH流程说明

1. 密钥生成阶段：

通信方A生成自己的密钥对：公钥A和私钥A。
通信方B生成自己的密钥对：公钥B和私钥B。

2. 协商阶段：

通信方A将公钥A发送给通信方B。
通信方B将公钥B发送给通信方A。
通信方A使用自己的私钥A和通信方B的公钥B生成共享密钥Kab。
通信方B使用自己的私钥B和通信方A的公钥A生成共享密钥Kab。

3. 密钥派生阶段：

通信方A和通信方B使用共享密钥Kab生成对称密钥，用于加密通信。




